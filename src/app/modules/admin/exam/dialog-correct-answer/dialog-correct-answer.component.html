<!-- Header -->
<div class="flex flex-col max-h-screen -m-6">
    <div
        class="flex flex-0 items-center justify-between h-16 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-blue-500 text-on-primary dark">
        <div class="text-2xl font-medium">ผลการสอบ</div>
        <button mat-icon-button (click)="onCloseDialog()">
            <mat-icon class="text-current" [svgIcon]="'heroicons_outline:x'"></mat-icon>
        </button>
    </div>

    <!-- Main -->
    <div class="basis-full">
        <!-- Course -->
        <div class="flex flex-col shadow rounded-2xl overflow-hidden bg-card">
            <div class="flex flex-col divide-y border-t border-b">

                <ng-container *ngIf="dataExamAnswer.data">
                    <div class="flex flex-row sm:items-center py-6">
                        <div class="basis-full flex items-center">

                            <div class="ml-4">
                                <div
                                    class="flex flex-row mt-1 text-lg font-bold text-blue-800 dark:text-blue-50 dark:bg-blue-500">
                                    [ผลการสอบ] {{ dataExamAnswer.data.exam_round.exam.name }} {{
                                    dataExamAnswer.data.exam_round.exam.year }} : รอบที่
                                    {{ dataExamAnswer.data.exam_round.exam.round }} จำนวน {{
                                    dataExamAnswer.data.exam_round.exam.question_qty }} ข้อ

                                </div>

                                <div class="mt-2 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:book-open"></mat-icon>
                                    <div class="ml-2">สายงาน : {{ dataExamAnswer.data.exam_round.exam.line_work.name }}
                                    </div>
                                </div>

                                <div class="mt-1 flex items-center leading-5 text-md text-secondar">
                                    <mat-icon svgIcon="heroicons_outline:clock"></mat-icon>
                                    <div class="ml-2">ระยะเวลาสอบ : {{ dataExamAnswer.data.exam_round.exam.exam_time }}
                                        นาที
                                    </div>
                                </div>

                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:location-marker"></mat-icon>
                                    <div class="ml-2">สนามสอบ : {{ dataExamAnswer.data.exam_field.name }}</div>
                                </div>

                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:calendar"></mat-icon>
                                    <div class="ml-2">วันที่สอบ : {{ dataExamAnswer.data.exam_round.exam_date }}</div>
                                </div>
                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:clock"></mat-icon>
                                    <div class="ml-2">เริ่มสอบเวลา : {{ dataExamAnswer.data.exam_round.start_time }}
                                        &nbsp;&nbsp;&nbsp; สิ้นสุดสอบเวลา : {{ dataExamAnswer.data.exam_round.end_time
                                        }}
                                    </div>
                                </div>

                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:user"></mat-icon>
                                    <div class="ml-2">ผู้สอบ : {{ dataExamAnswer.data.member.prefix.sub_name }} {{
                                        dataExamAnswer.data.member.fname }} {{ dataExamAnswer.data.member.lname }}
                                    </div>
                                </div>

                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:briefcase"></mat-icon>
                                    <div class="ml-2">ตำแหน่ง : {{ dataExamAnswer.data.member.position.sub_name }}
                                    </div>
                                </div>
                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:office-building"></mat-icon>
                                    <div class="ml-2">หน่วยงาน : {{ dataExamAnswer.data.member.division }} </div>
                                </div>

                                <div *ngFor="let coutsub of dataExamAnswer.data.countSubject; let i=index;"
                                    class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:book-open"></mat-icon>
                                    <div class="ml-2">รายวิชาที่สอบ {{i+1}}. {{ coutsub.exam_subjects }} : ได้คะแนน [ {{
                                        coutsub.score }} คะแนน ]</div>
                                </div>

                                <div class="mt-1 flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:check-circle"></mat-icon>
                                    <div *ngIf="dataExamAnswer.data.send_answer =='Not Send'" class="ml-2">สถานะส่งคำตอบ
                                        :
                                        ไม่ได้ส่งคำตอบ</div>
                                    <div *ngIf="dataExamAnswer.data.send_answer =='Send'" class="ml-2">สถานะส่งคำตอบ :
                                        ส่งคำตอบทันเวลา</div>
                                    <div *ngIf="dataExamAnswer.data.send_answer =='Send late'" class="ml-2">
                                        สถานะส่งคำตอบ :
                                        ส่งคำตอบล่าช้า</div>
                                </div>

                                <div class="mt-1 text-lg flex items-center leading-5 text-md font-medium">
                                    <mat-icon svgIcon="heroicons_outline:question-mark-circle"></mat-icon>
                                    <!-- <div class="ml-2 flex">ผลสอบ :&nbsp;
                                            <ng-container>
                                                <div *ngIf="dataExamAnswer.data.status =='Pass'" class="py-0.5 px-3 rounded-full text-sm font-semibold 
                                                  text-green-800 bg-green-100 dark:text-blue-50 dark:bg-blue-500"> สอบผ่าน </div>
                                                <div *ngIf="dataExamAnswer.data.status =='Not Pass'" class="py-0.5 px-3 rounded-full text-sm font-semibold
                                                  text-green-800 bg-green-100 dark:text-blue-50 dark:bg-blue-500"> สอบผ่าน </div>
                                            </ng-container>
                                        </div> -->

                                    <div class="ml-2 flex">ผลสอบ :&nbsp;
                                        <ng-container *ngIf="dataExamAnswer.data.send_answer != 'Not Send'">
                                            <div *ngIf="dataExamAnswer.data.exam_member_answer_results.score >= dataExamAnswer.data.exam_round.exam.all_score_pass"
                                                class="py-0.5 px-3 rounded-full text-sm font-semibold text-green-800 bg-green-100 dark:text-blue-50 dark:bg-blue-500">
                                                {{ dataExamAnswer.data.exam_member_answer_results.score }}/{{
                                                dataExamAnswer.data.exam_round.exam.question_qty }} </div>

                                            <div *ngIf="dataExamAnswer.data.exam_member_answer_results.score < dataExamAnswer.data.exam_round.exam.all_score_pass"
                                                class="py-0.5 px-3 rounded-full text-sm font-semibold text-red-800 bg-red-100 dark:text-blue-50 dark:bg-blue-500">
                                                {{ dataExamAnswer.data.exam_member_answer_results.score }}/{{
                                                dataExamAnswer.data.exam_round.exam.question_qty }} </div>
                                        </ng-container>

                                        <ng-container *ngIf="dataExamAnswer.data.send_answer == 'Not Send'">
                                            <div
                                                class="py-0.5 px-3 rounded-full text-sm font-semibold text-green-800 bg-green-100 dark:text-blue-50 dark:bg-blue-500">
                                                0/{{ dataExamAnswer.data.exam_round.exam.question_qty }} </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div class="flex flex-col w-60 mt-auto">
                            <ng-container *ngIf="!dataExamAnswer.data.exam_member_answer_results">
                                <div class="px-6 py-2 text-right">
                                    <div
                                        class="col-span-2 sm:col-span-1 flex flex-col items-center justify-center py-8 px-1 rounded-2xl bg-red-100 text-red-800 dark:bg-white dark:bg-opacity-5">
                                        <div class="text-5xl font-semibold leading-none tracking-tight">
                                            ไม่ผ่าน </div>
                                        <!-- <div class="mt-1 font-medium text-center">คะแนน</div> -->
                                    </div>
                                </div>
                            </ng-container>

                            <ng-container *ngIf="dataExamAnswer.data.exam_member_answer_results">
                                <ng-container
                                    *ngIf="dataExamAnswer.data.exam_member_answer_results.score >= dataExamAnswer.data.exam_round.exam.all_score_pass">
                                    <div class="px-6 py-2 text-right">
                                        <div
                                            class="col-span-2 sm:col-span-1 flex flex-col items-center justify-center py-8 px-1 rounded-2xl bg-green-100 text-green-800 dark:bg-white dark:bg-opacity-5">
                                            <div class="text-5xl font-semibold leading-none tracking-tight"> ผ่าน </div>
                                        </div>
                                    </div>

                                    <!-- <a type="button" mat-stroked-button
                                    class="px-4 py-4 mx-4 mt-2 font-bold mdc-button mat-primary bg-blue-700 text-white mat-mdc-button-base mat-mdc-b"
                                    href="https://police-exam.dev-asha.com/api/get_exam_cert_memberPDF?exam_round_member_id={{dataExamAnswer.data.exam_member_answer_results.exam_round_member_id}}"
                                    target="_blank">
                                    <span class="inline-flex items-center">
                                        <span> ใบรับรองหลักสูตร </span>
                                    </span>
                                </a> -->
                                </ng-container>

                                <ng-container
                                    *ngIf="dataExamAnswer.data.exam_member_answer_results.score < dataExamAnswer.data.exam_round.exam.all_score_pass">
                                    <div class="px-6 py-2 text-right">
                                        <div
                                            class="col-span-2 sm:col-span-1 flex flex-col items-center justify-center py-8 px-1 rounded-2xl bg-red-100 text-red-800 dark:bg-white dark:bg-opacity-5">
                                            <div class="text-5xl font-semibold leading-none tracking-tight"> ไม่ผ่าน
                                            </div>
                                            <!-- <div class="mt-1 font-medium text-center">คะแนน</div> -->
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>

                        </div>

                    </div>


                    <ng-container *ngIf="dataExamAnswer.data.result.length > 0">
                        <div class="flex flex-row sm:items-center py-6">
                            <div class="basis-full flex items-center">

                                <div class="ml-4">
                                    <div
                                        class="flex flex-row mt-1 text-lg font-bold text-green-700 dark:text-green-50 dark:bg-green-500">
                                        [เฉลยคำตอบ] {{ dataExamAnswer.data.exam_round.exam.name }} {{
                                        dataExamAnswer.data.exam_round.exam.year }} : รอบที่
                                        {{ dataExamAnswer.data.exam_round.exam.round }} จำนวน {{
                                        dataExamAnswer.data.exam_round.exam.question_qty }} ข้อ
                                    </div>

                                    <div class="p-3">
                                        <ng-container
                                            *ngFor="let resultExam of dataExamAnswer.data.result; let i=index;">
                                            <div class="ml-1">{{i+1}}. {{
                                                resultExam.exam_group_subject_answer.exam_group_subject_question.question
                                                }}
                                            </div>
                                            <img *ngIf="resultExam.exam_group_subject_answer.main_answer.main_question.image"
                                                src="{{resultExam.exam_group_subject_answer.main_answer.main_question.image}}"
                                                class="mt-3 mb-3 ml-2 w-40 border-solid border-2">

                                            <p *ngIf="resultExam.exam_group_subject_answer.main_answer.type=='Text'"
                                                class="mt-1 ml-2 font-bold text-green-500">
                                                [เฉลย] {{ resultExam.exam_group_subject_answer.main_answer.answer }}</p>

                                            <div class="mt-1 ml-2 font-bold text-green-500"
                                                *ngIf="resultExam.exam_group_subject_answer.main_answer.type=='Image'">
                                                [เฉลย] <img
                                                    src="https://police-exam.dev-asha.com/{{resultExam.exam_group_subject_answer.main_answer.answer}}"
                                                    class="mb-3 ml-2 w-40 border-solid border-2">
                                            </div>

                                        </ng-container>
                                    </div>

                                    <!-- <div class="flex flex-col">
                                            <div *ngFor="let resultExam of dataExamAnswer.data.result; let i=index;" class="mt-1 flex items-center leading-5 text-md font-medium">
                                                <div class="ml-4">{{i+1}}. {{ resultExam.exam_group_subject_answer.main_answer.main_question.name }} </div>
                                                <div class="ml-4">[เฉลย] {{ resultExam.exam_group_subject_answer.answer }}</div>
                                            </div>
                                         </div> -->

                                </div>

                            </div>
                        </div>
                    </ng-container>

                </ng-container>

                    <!-- Actions -->
                    <div class="flex flex-col sm:flex-row sm:items-center justify-end my-4 sm:mt-4">
                        <div class="flex items-center mr-6 mt-4">
                            <!-- <button class="ml-auto sm:ml-0" mat-icon-button>
                                <mat-icon [svgIcon]="'heroicons_outline:trash'"></mat-icon>
                              </button> -->
                            <!-- Send -->
                            <button class="sm:ml-3 order-first sm:order-last" mat-flat-button [color]="'primary'" (click)="onCloseDialog()">
                                ปิด, ออกจากข้อสอบ
                            </button>
                        </div>
                    </div>
                
            </div>
        </div>
    </div>


</div>